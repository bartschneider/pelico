import{S as M,i as j,s as F,d as u,t as k,a as b,c as V,b as g,e as y,f as p,g as d,h as w,j as q,k as x,l as _,m as I,o as G,n as m,p as T,q as W,r as A,u as L,v as H,w as P,x as S,y as z}from"../chunks/-3cQnFvs.js";import{e as $,u as B,G as J,o as K}from"../chunks/CcNbzAFb.js";import"../chunks/IHki7fMi.js";function C(c,t,e){const n=c.slice();return n[5]=t[e],n}function N(c){let t,e=[],n=new Map,o,r=$(c[0]);const i=s=>s[5].id;for(let s=0;s<r.length;s+=1){let l=C(c,r,s),a=i(l);n.set(a,e[s]=D(a,l))}return{c(){t=_("div");for(let s=0;s<e.length;s+=1)e[s].c();this.h()},l(s){t=d(s,"DIV",{class:!0});var l=w(t);for(let a=0;a<e.length;a+=1)e[a].l(l);l.forEach(u),this.h()},h(){p(t,"class","row")},m(s,l){g(s,t,l);for(let a=0;a<e.length;a+=1)e[a]&&e[a].m(t,null);o=!0},p(s,l){l&9&&(r=$(s[0]),L(),e=B(e,l,i,1,s,r,n,t,K,D,null,C),V())},i(s){if(!o){for(let l=0;l<r.length;l+=1)b(e[l]);o=!0}},o(s){for(let l=0;l<e.length;l+=1)k(e[l]);o=!1},d(s){s&&u(t);for(let l=0;l<e.length;l+=1)e[l].d()}}}function O(c){let t,e;return{c(){t=_("div"),e=A(c[2]),this.h()},l(n){t=d(n,"DIV",{class:!0});var o=w(t);e=W(o,c[2]),o.forEach(u),this.h()},h(){p(t,"class","alert alert-danger")},m(n,o){g(n,t,o),y(t,e)},p(n,o){o&4&&T(e,n[2])},i:m,o:m,d(n){n&&u(t)}}}function Q(c){let t,e="Loading wishlist...";return{c(){t=_("p"),t.textContent=e},l(n){t=d(n,"P",{"data-svelte-h":!0}),q(t)!=="svelte-16qtdg7"&&(t.textContent=e)},m(n,o){g(n,t,o)},p:m,i:m,o:m,d(n){n&&u(t)}}}function D(c,t){let e,n,o,r;function i(){return t[4](t[5])}return n=new J({props:{game:t[5].game}}),n.$on("delete",i),{key:c,first:null,c(){e=_("div"),z(n.$$.fragment),o=I(),this.h()},l(s){e=d(s,"DIV",{class:!0});var l=w(e);S(n.$$.fragment,l),o=x(l),l.forEach(u),this.h()},h(){p(e,"class","col-lg-3 col-md-4 col-sm-6 mb-4"),this.first=e},m(s,l){g(s,e,l),P(n,e,null),y(e,o),r=!0},p(s,l){t=s;const a={};l&1&&(a.game=t[5].game),n.$set(a)},i(s){r||(b(n.$$.fragment,s),r=!0)},o(s){k(n.$$.fragment,s),r=!1},d(s){s&&u(e),H(n)}}}function R(c){let t,e,n='<h1>Wishlist</h1> <button class="btn btn-primary"><i class="fas fa-plus me-1"></i> Add Game to Wishlist</button>',o,r,i,s;const l=[Q,O,N],a=[];function v(h,f){return h[1]?0:h[2]?1:2}return r=v(c),i=a[r]=l[r](c),{c(){t=_("div"),e=_("div"),e.innerHTML=n,o=I(),i.c(),this.h()},l(h){t=d(h,"DIV",{class:!0});var f=w(t);e=d(f,"DIV",{class:!0,"data-svelte-h":!0}),q(e)!=="svelte-qggn8k"&&(e.innerHTML=n),o=x(f),i.l(f),f.forEach(u),this.h()},h(){p(e,"class","d-flex justify-content-between align-items-center mb-4"),p(t,"class","container-fluid mt-4")},m(h,f){g(h,t,f),y(t,e),y(t,o),a[r].m(t,null),s=!0},p(h,[f]){let E=r;r=v(h),r===E?a[r].p(h,f):(L(),k(a[E],1,1,()=>{a[E]=null}),V(),i=a[r],i?i.p(h,f):(i=a[r]=l[r](h),i.c()),b(i,1),i.m(t,null))},i(h){s||(b(i),s=!0)},o(h){k(i),s=!1},d(h){h&&u(t),a[r].d()}}}function U(c,t,e){let n=[],o=!0,r=null;G(async()=>{try{const l=await fetch("/api/v1/wishlist");l.ok?e(0,n=await l.json()):e(2,r="Failed to load wishlist from the backend.")}catch(l){e(2,r="Error connecting to the backend."),console.error(l)}finally{e(1,o=!1)}});async function i(l){try{(await fetch(`/api/v1/wishlist/${l}`,{method:"DELETE"})).ok?e(0,n=n.filter(v=>v.game.id!==l)):alert("Failed to remove game from wishlist.")}catch(a){alert("An error occurred while removing the game from the wishlist."),console.error(a)}}return[n,o,r,i,l=>i(l.game.id)]}class ee extends M{constructor(t){super(),j(this,t,U,R,F,{})}}export{ee as component};
